<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>GRAPHICX - Windows</title>
<link rel="icon" href="/assets/images/logo.ico" type="image/x-icon">
<meta property="og:type" content="website">
<meta property="og:url" content="https://graphicx.store/windows">
<meta property="og:title" content="GRAPHICX - Engineering">
<meta property="og:description" content="Collection complète de plugins, extensions et logiciels pour After Effects, Premiere Pro, Photoshop et plus. Téléchargements gratuits de Maxon Red Giant, Boris FX, Video Copilot et bien d'autres.">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:site_name" content="GRAPHICX">
<meta property="og:locale" content="fr_FR">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500;700;900&family=Oswald:wght@700&display=swap" rel="stylesheet">    
    <script src="list.js"></script> 
<style>
        /* -------------------------------------- */
        /* 1. VARIABLES & RESET (BASE) */
        /* -------------------------------------- */
        :root {
            --color-primary: #FF0033;   /* Rouge Vif - Flux/Accent */
            --color-secondary: #CCCCCC; /* Gris Clair - Détails/Sous-titres */
            --color-bg: #0A0A0A;        /* Noir Profond */
            --color-text: #FFFFFF;      /* Texte Blanc Pur */
            --color-light-bg: #1A1A1A;  /* Arrière-plan des cartes/liens (OPAQUE) */
            --color-border: #1D1D1D;    /* Bordures subtiles */
            --color-attention: #FF0055; /* Rouge/Rose pour l'avertissement */
            --color-discord: #5865F2;   /* Nouveau : Violet Discord */
            --font-main: 'Montserrat', sans-serif;
            --font-title: 'Oswald', sans-serif;
            --transition-speed: 0.35s; 
            --glow-shadow: 0 0 12px rgba(255, 0, 51, 0.7); 
            --glow-shadow-discord: 0 0 12px rgba(88, 101, 242, 0.7);
            --color-card-border: #2A2A2A; 
        }

        /* --- NOUVEAUX KEYFRAMES POUR LES ANIMATIONS --- */
        @keyframes glow-pulse {
            0% { text-shadow: 0 0 5px var(--color-primary), 0 0 10px rgba(255, 0, 51, 0.4); }
            50% { text-shadow: 0 0 10px var(--color-primary), 0 0 20px rgba(255, 0, 51, 0.8); }
            100% { text-shadow: 0 0 5px var(--color-primary), 0 0 10px rgba(255, 0, 51, 0.4); }
        }

        @keyframes tag-pop-in {
            from { transform: scale(0.8); opacity: 0; filter: blur(3px); }
            to { transform: scale(1); opacity: 1; filter: blur(0); }
        }
        
        @keyframes card-fade-in {
            /* AJOUT DU scale(0.98) au départ pour un effet subtil */
            from { opacity: 0; transform: translateY(20px) scale(0.98); } 
            /* MODIFICATION CRITIQUE: Assurer que l'état final est exactement scale(1) pour relâcher le transform */
            to { opacity: 1; transform: translateY(0) scale(1); } 
        }
        /* ----------------------------------------------- */

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--color-bg);
            color: var(--color-text);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        a {
            color: var(--color-primary);
            text-decoration: none;
            transition: color var(--transition-speed), opacity var(--transition-speed);
            cursor: pointer;
        }

        a:hover {
            opacity: 0.8;
        }

        /* FOND PARTICULES */
        #particle-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 0; 
            opacity: 0.85; 
        }

        /* Conteneur principal - Devant le canvas */
        #main-container {
            position: relative;
            z-index: 10; 
        }

        /* -------------------------------------- */
        /* 2. HEADER / NAVIGATION */
        /* -------------------------------------- */
        header {
            position: sticky;
            top: 0;
            width: 100%;
            padding: 20px 5%;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(10, 10, 10, 0.98); 
            backdrop-filter: blur(8px);
            border-bottom: 1px solid var(--color-border);
        }

        .logo {
            font-size: 1.6em;
            font-family: var(--font-title);
            font-weight: 700;
            letter-spacing: 1px;
            color: var(--color-text);
        }

        .logo span {
            color: var(--color-primary);
            font-size: 0.8em;
            /* ANIMATION DE FLUX/DÉGRADÉ (GLOW) */
            animation: glow-pulse 3s infinite alternate; 
        }

        .nav-links a {
            color: var(--color-secondary);
            margin-left: 25px;
        }
        
        .nav-links a:hover {
            color: var(--color-primary);
            text-shadow: 0 0 3px var(--color-primary); 
            opacity: 1;
        }
        
        /* -------------------------------------- */
        /* 3. SECTION CONTENU (Liste WINDOWS) */
        /* -------------------------------------- */
        .content-section {
            padding: 60px 5%; 
            max-width: 1400px; 
            margin: 0 auto;
            position: relative;
            z-index: 10;
        }

        .page-title {
            font-family: var(--font-title);
            font-size: clamp(2rem, 5vw, 4rem);
            font-weight: 700;
            text-align: center;
            margin-bottom: 50px; 
            color: var(--color-text);
        }
        
        .page-title span {
             color: var(--color-primary);
             /* ANIMATION DE FLUX/DÉGRADÉ (GLOW) */
             animation: glow-pulse 3s infinite alternate; 
        }

        /* --- FILTRES ET RECHERCHE (NOUVEAU) --- */

        /* Conteneur de style sombre inspiré de 'exemple à suivre.html' */
        #filter-controls {
            /* Cadre : Légère transparence et contour */
            background-color: rgba(26, 26, 26, 0.95); 
            padding: 20px 40px;
            border: 1px solid var(--color-border); 
            display: flex;
            flex-direction: column;
            gap: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4);
            border-radius: 8px; 
            margin-bottom: 40px;
        }
        
        .search-row {
            display: flex;
            gap: 15px;
        }
        
        /* Conteneur principal pour positionner le bouton de suppression */
        .search-container {
            flex-grow: 1;
            position: relative; /* Pour le dropdown des tags et le bouton clear */
        }

        .search-container input {
            width: 100%;
            padding: 12px 15px;
            /* Ajustement pour laisser de la place au bouton de suppression */
            padding-right: 40px; 
            background-color: var(--color-bg);
            border: 1px solid var(--color-border);
            color: var(--color-text);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color var(--transition-speed), box-shadow var(--transition-speed);
        }
        
        .search-container input:focus {
            border-color: var(--color-primary);
            outline: none;
            box-shadow: 0 0 8px rgba(255, 0, 51, 0.7); 
        }

        /* Bouton de suppression du contenu */
        .clear-search-btn {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--color-secondary);
            font-size: 20px;
            cursor: pointer;
            padding: 0 5px;
            line-height: 1;
            transition: color 0.2s;
            z-index: 21; /* Au-dessus des suggestions de tags */
        }
        
        .clear-search-btn:hover {
            color: var(--color-primary);
        }


        /* Suggestions de Tags (Dropdown) */
        .tag-suggestions {
            position: absolute;
            top: 100%; 
            left: 0;
            right: 0;
            z-index: 20;
            background-color: var(--color-light-bg);
            border: 1px solid var(--color-primary);
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 200px;
            overflow-y: auto;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.5);
            display: none; /* Caché par défaut */
        }
        
        .tag-suggestions.active {
            display: block;
        }

        .tag-suggestion-item {
            padding: 10px 15px;
            cursor: pointer;
            color: var(--color-secondary);
            transition: background-color var(--transition-speed), color var(--transition-speed);
        }

        .tag-suggestion-item:hover, .tag-suggestion-item.highlighted {
            background-color: rgba(255, 0, 51, 0.1);
            color: var(--color-primary);
        }
        
        /* Conteneur des tags sélectionnés */
        #selected-tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            min-height: 30px; 
        }
        
        .selected-tag {
            background-color: var(--color-primary);
            color: var(--color-bg);
            padding: 5px 10px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: default;
            user-select: none;
            /* ANIMATION D'APPARITION DU TAG */
            animation: tag-pop-in 0.3s ease-out; 
            box-shadow: 0 0 8px rgba(255, 0, 51, 0.8); /* Glow plus intense */
        }
        
        .remove-tag-btn {
            background: none;
            border: none;
            color: var(--color-bg);
            font-weight: 900;
            cursor: pointer;
            font-size: 16px;
            line-height: 1;
            padding: 0 2px;
            transition: transform 0.2s;
        }

        .remove-tag-btn:hover {
            transform: rotate(90deg);
        }

        /* --- GRILLE DE POSTS --- */

        #posts-grid {
            display: grid;
            /* TAILLE CORRIGÉE : Max 380px pour que 3 colonnes s'affichent confortablement dans le conteneur 1400px */
            grid-template-columns: repeat(auto-fit, minmax(350px, 380px)); 
            gap: 30px;
            padding-top: 20px;
            justify-content: center; /* Centrer les cartes si elles ne remplissent pas la ligne */
        }
        
        #posts-grid.empty-state {
            display: block;
            text-align: center;
            color: var(--color-secondary);
            padding: 50px;
            font-size: 1.2em;
        }

        .post-card {
            background: rgba(26, 26, 26, 0.8); 
            border: 1px solid var(--color-card-border); 
            border-radius: 8px;
            overflow: hidden;
            /* FIX 1: Transition explicite et complète */
            transition: transform var(--transition-speed) ease-out, box-shadow var(--transition-speed) ease-out, border-color var(--transition-speed) ease-out; 
            /* FIX 2 CRITIQUE: Etat de base du transform + Force l'accélération matérielle pour débloquer le hover */
            transform: scale(1) translateY(0) translateZ(0); 
            /* FIX 3: S'assurer que la carte survolée est au-dessus des autres */
            z-index: 1; 
            /* OPTIMISATION: Aide le navigateur pour les transitions à venir */
            will-change: transform, box-shadow;
            display: flex;
            flex-direction: column;
            position: relative;
            /* L'animation d'apparition étagée est ajoutée via JS dans l'attribut style */
        }
        
        /* L'animation de ZOOM/DÉZOOM est ici */
        .post-card:hover {
            /* FIX 4: Application du zoom + Maintien de l'accélération matérielle */
            transform: translateY(-5px) scale(1.02) translateZ(1px); 
            /* FIX 5: Assurer que la carte survolée est au-dessus des autres */
            z-index: 2; 
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.6), var(--glow-shadow); 
            border-color: var(--color-primary);
        }

        .post-thumbnail {
            width: 100%;
            height: 120px; 
            object-fit: contain;
            background: #000000;            
	    border-bottom: 1px solid var(--color-border);
	    padding: 10px;
        }
        
        /* Si l'image n'est pas dans un lien, on veut que le curseur ne soit pas la main */
        .post-card > .post-thumbnail {
            cursor: default;
        }

        .post-content {
            padding: 15px 20px;
            flex-grow: 1; 
            display: flex;
            flex-direction: column;
        }
        
        .post-content h3 {
            font-family: var(--font-title);
            font-size: 1.4em;
            font-weight: 700;
            color: var(--color-text); 
            margin-bottom: 5px;
            line-height: 1.2;
            transition: text-shadow 0.3s;
        }
        
        .post-card:hover .post-content h3 {
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.7); 
        }

        .post-content .version {
            font-size: 0.8em;
            color: var(--color-secondary);
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .post-content .description {
            font-size: 0.9em;
            color: var(--color-secondary);
            margin-bottom: 15px; 
            flex-grow: 1; 
        }
        
        .post-content .information {
            font-size: 0.8em;
            color: var(--color-attention);
            background-color: rgba(255, 0, 85, 0.1);
            padding: 8px;
            border-radius: 4px;
            border-left: 3px solid var(--color-attention);
        }
        
        .information-toggle-content {
            max-height: 0; 
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, margin-bottom 0.5s ease-in-out;
            margin-bottom: 0; 
        }
        
        .information-toggle-content.hidden {
            max-height: 0 !important; 
            margin-bottom: 0 !important;
        }
        
        .info-button {
            display: inline-block;
            padding: 8px 18px;
            /* FIX FINAL: Utiliser une largeur fixe pour éviter tout changement de taille */
            width: 135px; 
            background-color: var(--color-light-bg);
            color: var(--color-attention); 
            border: 1px solid var(--color-attention);
            font-weight: 500;
            border-radius: 50px;
            transition: all var(--transition-speed);
            font-size: 0.9em;
            text-align: center;
            cursor: pointer;
        }

        .info-button:hover {
            background-color: rgba(255, 0, 85, 0.2); 
            color: #FF77A1;
            transform: scale(1.05);
            opacity: 1;
        }

        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 15px;
            border-top: 1px solid var(--color-border);
        }

        .post-size {
            font-family: var(--font-title);
            font-size: 1.1em;
            font-weight: 700;
            color: var(--color-secondary);
        }

        .card-footer-buttons {
            display: flex;
            gap: 10px;
        }
        
        .download-button {
            padding: 8px 18px;
            background-color: var(--color-primary);
            color: var(--color-bg);
            font-weight: 700;
            border-radius: 50px;
            transition: background-color 0.3s, transform 0.3s;
            font-size: 0.9em;
            text-align: center;
        }

        .download-button:hover {
            background-color: #FF4D6A;
            transform: scale(1.05);
            opacity: 1;
        }

        .post-tags {
            display: flex; 
            flex-wrap: nowrap; 
            overflow-x: auto; 
            gap: 5px; 
            margin-top: 10px;
            margin-bottom: 15px;
            padding-bottom: 5px;
            
            &::-webkit-scrollbar {
                display: none;
                width: 0 !important;
                height: 0 !important;
            }
            
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .post-tags span {
            flex-shrink: 0; 
            background-color: rgba(255, 0, 51, 0.1);
            color: var(--color-primary);
            font-size: 0.75em;
            padding: 3px 8px;
            border-radius: 4px;
            text-transform: uppercase;
            font-weight: 600;
        }

        /* -------------------------------------- */
        /* 4. FOOTER & AVERTISSEMENT */
        /* -------------------------------------- */
        footer {
            text-align: center;
            padding: 40px 5%;
            border-top: 1px solid var(--color-border);
            font-size: 0.9em;
            color: #444444;
            margin-top: 40px; 
            background-color: var(--color-bg);
            position: relative;
            z-index: 10;
        }

        #legal-disclaimer {
            padding: 15px 5%;
            margin-bottom: 20px;
            background-color: var(--color-light-bg); 
            border: 1px solid var(--color-attention);
            border-radius: 6px;
            color: var(--color-secondary);
            font-size: 0.85em;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        #legal-disclaimer strong {
            color: var(--color-attention);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: block;
            margin-bottom: 5px;
        }
        
        /* -------------------------------------- */
        /* 5. MEDIA QUERIES */
        /* -------------------------------------- */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                padding: 15px 5%;
            }

            .nav-links {
                margin-top: 10px;
            }

            .nav-links a {
                margin: 0 10px;
            }
            
            #posts-grid {
                /* S'assurer que le mode mobile utilise 1fr pour remplir l'écran */
                grid-template-columns: 1fr; 
                justify-content: unset; /* Désactiver le centrage sur mobile */
            }
            
            .post-card {
                flex-direction: row;
                text-align: left;
            }
            
            .post-thumbnail {
                width: 120px;
                height: auto;
                object-fit: cover;
                border-bottom: none;
                border-right: 1px solid var(--color-border);
            }
            
            .post-content {
                padding: 15px;
            }
            
            .card-footer {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .card-footer-buttons {
                margin-top: 10px;
                flex-direction: row; 
            }
            
            .search-row {
                flex-direction: column;
                gap: 15px;
            }
            
            #filter-controls {
                padding: 20px;
            }
        }
    </style>
</head>
<body>

    <canvas id="particle-canvas"></canvas>

    <div id="main-container">
        <header>
            <a href="../" class="logo">GRAPHICX<span>.STORE</span></a>
            <nav class="nav-links">
                <a href="../#hero">Accueil</a>
                <a href="../#categories">Ressources</a>
                <a href="https://discord.com/invite/CNudm6aJ2n" style="color: var(--color-primary); font-weight: 700;">Discord</a>
            </nav>
        </header>

        <main>
            <section class="content-section">
                <h1 class="page-title">Engineering <span>WINDOWS</span></h1>

                <div id="filter-controls">
                    <div class="search-row">
                        <div class="search-container">
                            <input type="text" id="name-search-bar" placeholder="Recherche par nom (ex: Maxon Red Giant+Boris FX Continuum)">
                            <button id="clear-name-search" class="clear-search-btn" style="display: none;">&times;</button>
                        </div>
                    </div>
                    
                    <div class="search-row">
                        <div class="search-container">
                            <input type="text" id="tag-search-bar" placeholder="Rechercher ou ajouter un tag (ex: 3D, Design, Utilitaires)">
                            <div class="tag-suggestions" id="tag-suggestions">
                                </div>
                        </div>
                    </div>
                    
                    <div id="selected-tags-container">
                        </div>
                </div>

                <div id="posts-grid">
                    </div>

            </section>
        </main>

        <footer>
            <section id="legal-disclaimer">
                <strong>AVERTISSEMENT LÉGAL ET RESPONSABILITÉ :</strong> Ce site n'héberge, ne stocke ni ne distribue directement aucun fichier. Toutes les ressources sont liées à des services d'hébergement tiers. Nous ne sommes en aucun cas responsables du contenu, de la légalité ou des risques potentiels liés aux sites externes référencés. L'utilisateur utilise ces ressources sous sa propre responsabilité.
            </section>
            
            &copy; 2025 GRAPHICX.STORE. Tous droits réservés. | Contactez-nous pour toute question légale ou DMCA. | <a href="https://discord.com/invite/CNudm6aJ2n" style="color: var(--color-primary); font-weight: 700;">Rejoindre le Discord</a>
        </footer>
    </div>

    <script>
        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.vx = Math.random() * 2 - 1;
                this.vy = Math.random() * 2 - 1;
                this.radius = Math.random() * 2 + 1;
                this.color = color;
                this.alpha = 1;
                this.life = 400;
                this.maxLife = 400;
            }

            draw(ctx) {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false);
                ctx.fillStyle = `rgba(${this.color}, ${this.alpha * 0.5})`;
                ctx.fill();
            }

            update(mouse) {
                this.x += this.vx;
                this.y += this.vy;
                this.life--;
                this.alpha = this.life / this.maxLife;

                const dx = mouse.x - this.x;
                const dy = mouse.y - this.y;
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < 100) {
                    const force = 0.05;
                    this.vx += (dx / distance) * force;
                    this.vy += (dy / distance) * force;
                }

                this.vx *= 0.98;
                this.vy *= 0.98;
            }
        }

        let canvas, ctx, mouse, particles;
        const particleColor = '255, 0, 51'; // Rouge

        function initParticles() {
            canvas = document.getElementById('particle-canvas');
            if (!canvas) return;
            ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            particles = [];
            mouse = { x: window.innerWidth / 2, y: window.innerHeight / 2 };

            window.addEventListener('mousemove', (e) => {
                mouse.x = e.x;
                mouse.y = e.y;
                for(let i = 0; i < 2; i++) {
                     particles.push(new Particle(e.x, e.y, particleColor));
                }
            });

            window.addEventListener('resize', () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });

            animateParticles();
        }

        function animateParticles() {
            requestAnimationFrame(animateParticles);
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            particles = particles.filter(p => p.life > 0);

            particles.forEach(particle => {
                particle.update(mouse);
                particle.draw(ctx);
            });
        }
    </script>
    
    <script>
        const nameSearchBar = document.getElementById('name-search-bar');
        const tagSearchBar = document.getElementById('tag-search-bar');
        const tagsSuggestionsContainer = document.getElementById('tag-suggestions');
        const selectedTagsContainer = document.getElementById('selected-tags-container');
        const postsContainer = document.getElementById('posts-grid');
        const clearNameSearchBtn = document.getElementById('clear-name-search'); 

        let allUniqueTags = [];
        let selectedTags = [];
        let highlightedSuggestion = -1;

        /**
         * Génère un ID unique et sécurisé à partir des données du post.
         */
        const generatePostId = (post) => 
            (post.title + post.size).replace(/[^a-zA-Z0-9]/g, '_').toLowerCase();


        /**
         * Bascule l'affichage du contenu d'information.
         * Logique affinée pour une transition max-height correcte et fluide.
         */
        function toggleInformation(button) {
            const targetId = button.dataset.targetId;
            const content = document.getElementById(targetId);
            
            if (content) {
                const isHidden = content.classList.contains('hidden');
                
                if (isHidden) {
                    // Expansion (Ouverture)
                    content.classList.remove('hidden');
                    
                    // 1. Définir temporairement la hauteur sur 'none' pour calculer la hauteur réelle (scrollHeight)
                    content.style.maxHeight = 'none'; 
                    const height = content.scrollHeight;
                    
                    // 2. Réinitialiser la hauteur à '0' (point de départ de la transition)
                    content.style.maxHeight = '0'; 
                    content.style.marginBottom = '0';
                    
                    // Force reflow/redraw (important pour que le navigateur voie le changement de 0 à la hauteur réelle)
                    void content.offsetHeight; 
                    
                    // 3. Application de l'ouverture
                    content.style.maxHeight = height + 'px';
                    content.style.marginBottom = '15px';
                    button.textContent = 'Masquer';

                    // 4. Nettoyage après transition : Repasser à 'none' pour rendre le contenu responsive
                    content.addEventListener('transitionend', function handler() {
                        if (content.style.maxHeight !== '0px') {
                           content.style.maxHeight = 'none'; 
                        }
                        content.removeEventListener('transitionend', handler);
                    }, { once: true });

                } else {
                    // Collapse (Fermeture)
                    
                    // 1. Définir la hauteur actuelle (point de départ de la transition)
                    content.style.maxHeight = content.scrollHeight + 'px'; 
                    content.style.marginBottom = '15px';
                    
                    // Force reflow/redraw
                    void content.offsetHeight; 
                    
                    // 2. Animer vers la fermeture
                    content.style.maxHeight = '0';
                    content.style.marginBottom = '0';
                    button.textContent = 'Informations';

                    // 3. Nettoyage après transition : Ajouter la classe 'hidden'
                    content.addEventListener('transitionend', function handler() {
                        content.classList.add('hidden');
                        content.removeEventListener('transitionend', handler);
                    }, { once: true });
                }
            }
        }
        
        /**
         * Attache l'écouteur d'événement 'wheel' pour le défilement horizontal.
         */
        function attachHorizontalScroll() {
            document.querySelectorAll('.post-tags').forEach(tagsElement => {
                tagsElement.addEventListener('wheel', (e) => {
                    if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {
                        e.preventDefault(); 
                        tagsElement.scrollLeft += e.deltaY;
                    }
                });
            });
        }

        /**
         * Génère le HTML pour une seule carte de post.
         */
        function createPostCard(post, index) { 
            const postId = generatePostId(post);
            const tagsHtml = post.tags.map(tag => `<span>${tag}</span>`).join('');
            const versionHtml = post.version ? `<div class="version">Version : ${post.version}</div>` : '';
            
            let informationContentHtml = '';
            let infoButtonHtml = '';

            if (post.information && post.information.trim() !== '') {
                informationContentHtml = `
                    <div id="info-content-${postId}" class="information-toggle-content hidden">
                        <div class="information">${post.information}</div>
                    </div>
                `;
                infoButtonHtml = `
                    <span class="info-button" 
                          data-target-id="info-content-${postId}" 
                          onclick="toggleInformation(this)">
                        Informations
                    </span>
                `;
            }

            // DÉTERMINER SI LE LIEN DE PRÉVISUALISATION EST VALIDE
            const hasValidPreviewLink = post.preview && post.preview.trim() !== '';
            const previewLink = hasValidPreviewLink ? post.preview : '#'; 

            // HTML de l'image miniature seule
            const thumbnailHtml = `<img src="${post.thumbnail}" alt="${post.title}" class="post-thumbnail" onerror="this.onerror=null;this.src='../assets/images/default.jpg';">`;
            
            // Condition pour créer le bloc image/lien (UNIQUEMENT si hasValidPreviewLink est vrai)
            const imageBlockHtml = hasValidPreviewLink
                ? `
                    <a href="${previewLink}" target="_blank" rel="noopener noreferrer">
                        ${thumbnailHtml}
                    </a>
                `
                : `
                    ${thumbnailHtml}
                `;


            // AJOUT DU STYLE POUR L'ANIMATION ÉTAGÉE (Staggered Animation)
            const maxIndexForDelay = 15;
            const delayIndex = Math.min(index, maxIndexForDelay);
            const cardStyle = `animation: card-fade-in 0.6s ease-out forwards; animation-delay: ${delayIndex * 0.08}s; opacity: 0;`;


            return `
                <div class="post-card" data-title="${post.title.toLowerCase()}" style="${cardStyle}">
                    ${imageBlockHtml} <div class="post-content">
                        <h3>${post.title}</h3>
                        ${versionHtml} 
                        <div class="post-tags" id="tags-${postId}">${tagsHtml}</div>
                        <p class="description">${post.description}</p>
                        
                        ${informationContentHtml} 
                        
                        <div class="card-footer">
                            <span class="post-size">${post.size}</span>
                            <div class="card-footer-buttons">
                                ${infoButtonHtml} 
                                <a href="${post.file}" class="download-button" target="_blank">Télécharger</a>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        /**
         * Met à jour l'URL avec les termes de recherche.
         */
        function updateURL() {
            const nameSearch = nameSearchBar.value.trim();
            const tagSearch = selectedTags.join('+');
            
            const searchTerms = [];
            if (nameSearch) searchTerms.push(nameSearch);
            if (tagSearch) searchTerms.push(`tag:${tagSearch}`);
            
            const searchParam = searchTerms.join('&');
            
            if (searchParam) {
                const newurl = window.location.protocol + "//" + window.location.host + window.location.pathname + '?search=' + encodeURIComponent(searchParam);
                window.history.pushState({path: newurl}, '', newurl);
            } else {
                const newurl = window.location.protocol + "//" + window.location.host + window.location.pathname;
                window.history.pushState({path: newurl}, '', newurl);
            }
        }
        
        /**
         * Lit l'URL et initialise la recherche.
         */
        function initSearchFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const searchParam = urlParams.get('search');
            
            if (searchParam) {
                const terms = decodeURIComponent(searchParam).split('&');
                
                terms.forEach(term => {
                    if (term.startsWith('tag:')) {
                        const tags = term.substring(4).split('+').filter(t => t.trim() !== '');
                        tags.forEach(tag => addTag(tag, false)); 
                    } else {
                        nameSearchBar.value = term;
                    }
                });
            }
            // Lancer la recherche initiale
            handleNameSearchInput(); 
        }

        /**
         * Affiche les tags actuellement sélectionnés.
         */
        function renderSelectedTags() {
            // Le fait de ré-écrire l'innerHTML permet de relancer l'animation CSS 'tag-pop-in' pour le nouveau tag.
            selectedTagsContainer.innerHTML = selectedTags.map(tag => `
                <span class="selected-tag" data-tag="${tag}">
                    ${tag}
                    <button class="remove-tag-btn" onclick="removeTag('${tag}')">&times;</button>
                </span>
            `).join('');
        }
        
        /**
         * Ajoute un tag à la liste de sélection et met à jour.
         */
        function addTag(tag, update = true) {
            tag = tag.trim();
            // Utiliser toLowerCase pour la comparaison interne des tags
            const lowerTag = tag.toLowerCase();
            if (lowerTag && !selectedTags.includes(lowerTag) && allUniqueTags.map(t => t.toLowerCase()).includes(lowerTag)) {
                // Stocker le tag en minuscule pour la recherche, mais on peut afficher le format original si besoin
                selectedTags.push(lowerTag); 
                tagSearchBar.value = '';
                tagsSuggestionsContainer.classList.remove('active');
                renderSelectedTags();
                if (update) {
                    searchAndFilter();
                }
            }
        }
        
        /**
         * Supprime un tag de la liste de sélection et met à jour.
         */
        function removeTag(tag) {
            selectedTags = selectedTags.filter(t => t !== tag.toLowerCase());
            renderSelectedTags();
            searchAndFilter();
        }

        /**
         * Affichage des suggestions de tags.
         */
        function renderTagSuggestions(filter) {
            tagsSuggestionsContainer.innerHTML = '';
            highlightedSuggestion = -1;
            
            const lowerFilter = filter.toLowerCase();
            
            const filteredSuggestions = allUniqueTags
                .filter(tag => !selectedTags.includes(tag.toLowerCase()) && tag.toLowerCase().includes(lowerFilter))
                .slice(0, 5); 
                
            if (filteredSuggestions.length > 0) {
                filteredSuggestions.forEach(tag => {
                    const item = document.createElement('div');
                    item.className = 'tag-suggestion-item';
                    item.textContent = tag;
                    item.onclick = () => addTag(tag);
                    tagsSuggestionsContainer.appendChild(item);
                });
                tagsSuggestionsContainer.classList.add('active');
            } else {
                tagsSuggestionsContainer.classList.remove('active');
            }
        }
        
        /**
         * Logique de recherche principale.
         */
        function searchAndFilter() {
            let filteredPosts = window.posts;
            const nameSearchTerm = nameSearchBar.value.toLowerCase().trim();
            
            // 1. Filtrage par noms (logique Phrase Match OR - Stricte sur Titre et Version)
            if (nameSearchTerm) {
                // Sépare les termes principaux par '+'. Chaque terme principal est une PHRASE exacte attendue.
                const primaryTerms = nameSearchTerm.split('+').map(t => t.trim()).filter(t => t);

                filteredPosts = filteredPosts.filter(post => {
                    // Contenu pertinent pour la recherche de NOM : Titre et Version uniquement (pour éviter la pollution par la description)
                    const searchableContent = (post.title + ' ' + (post.version || '') + ' ' + (post.information || '')).toLowerCase();
                    
                    // Le post est inclus si AU MOINS UN des termes principaux est trouvé
                    return primaryTerms.some(primaryTerm => {
                        // VÉRIFICATION DE LA PHRASE EXACTE dans le Titre ou la Version.
                        return searchableContent.includes(primaryTerm);
                    });
                });
            }

            // 2. Filtrage par tags sélectionnés
            if (selectedTags.length > 0) {
                // Un post doit contenir TOUS les tags sélectionnés (logique AND)
                filteredPosts = filteredPosts.filter(post => {
                    const postTagsLower = post.tags.map(t => t.toLowerCase());
                    return selectedTags.every(selectedTag => postTagsLower.includes(selectedTag));
                });
            }
            
            // Affichage des posts
            if (filteredPosts.length > 0) {
                // Utiliser .map avec index pour l'animation étagée
                postsContainer.innerHTML = filteredPosts.map((post, index) => createPostCard(post, index)).join('');
                postsContainer.classList.remove('empty-state');
                attachHorizontalScroll();
            } else {
                postsContainer.innerHTML = `<div class="empty-state-message">Aucun résultat trouvé pour votre recherche.</div>`;
                postsContainer.classList.add('empty-state');
            }
            
            // Mise à jour de l'URL après la recherche 
            updateURL();
        }
        
        /**
         * Gère l'input de la barre de recherche des noms et la visibilité du bouton clear.
         */
        function handleNameSearchInput() {
            searchAndFilter(); 
            
            // Visibilité du bouton clear
            if (clearNameSearchBtn) { // Vérification supplémentaire pour éviter les erreurs si l'élément n'est pas trouvé
                if (nameSearchBar.value.trim() !== '') {
                    clearNameSearchBtn.style.display = 'block';
                } else {
                    clearNameSearchBtn.style.display = 'none';
                }
            }
        }


        /**
         * Initialisation et écouteurs d'événements.
         */
        window.onload = () => {
            initParticles(); 

            if (typeof posts !== 'undefined' && posts.length > 0) {
                // Collecter tous les tags uniques
                const tagsSet = new Set();
                posts.forEach(post => post.tags.forEach(tag => tagsSet.add(tag)));
                allUniqueTags = Array.from(tagsSet).sort();
                
                // Initialiser la recherche depuis l'URL
                initSearchFromURL();
                
                // Événements pour la recherche par nom
                nameSearchBar.addEventListener('input', handleNameSearchInput);
                if (clearNameSearchBtn) {
                    clearNameSearchBtn.addEventListener('click', () => { 
                        nameSearchBar.value = '';
                        handleNameSearchInput(); 
                        nameSearchBar.focus();
                    });
                }
                
                // Événements pour la recherche par tags
                tagSearchBar.addEventListener('input', (e) => {
                    renderTagSuggestions(e.target.value);
                });
                
                // Afficher la liste des tags au focus (clic)
                tagSearchBar.addEventListener('focus', (e) => {
                    renderTagSuggestions(e.target.value);
                });
                
                // Gestion des touches (Entrée et Flèches) pour la barre de tags
                tagSearchBar.addEventListener('keydown', (e) => {
                    const suggestions = tagsSuggestionsContainer.querySelectorAll('.tag-suggestion-item');
                    if (suggestions.length === 0) return;
                    
                    if (e.key === 'ArrowDown') {
                        e.preventDefault();
                        highlightedSuggestion = (highlightedSuggestion + 1) % suggestions.length;
                    } else if (e.key === 'ArrowUp') {
                        e.preventDefault();
                        highlightedSuggestion = (highlightedSuggestion - 1 + suggestions.length) % suggestions.length;
                    } else if (e.key === 'Enter') {
                        e.preventDefault();
                        if (highlightedSuggestion >= 0) {
                            suggestions[highlightedSuggestion].click();
                        } else {
                            const tagValue = tagSearchBar.value.trim();
                            // Vérifiez si le tag est dans la liste des tags valides avant de l'ajouter
                            if(allUniqueTags.map(t => t.toLowerCase()).includes(tagValue.toLowerCase())) {
                                addTag(tagValue);
                            }
                        }
                        return;
                    }
                    
                    // Mise à jour de la classe 'highlighted'
                    suggestions.forEach((item, index) => {
                        item.classList.toggle('highlighted', index === highlightedSuggestion);
                    });
                    
                    if (highlightedSuggestion >= 0) {
                        suggestions[highlightedSuggestion].scrollIntoView({ block: 'nearest' });
                    }
                });

                // Cacher les suggestions lorsqu'on clique en dehors
                document.addEventListener('click', (e) => {
                    if (!tagSearchBar.contains(e.target) && !tagsSuggestionsContainer.contains(e.target)) {
                        tagsSuggestionsContainer.classList.remove('active');
                    }
                });
                
            } else {
                postsContainer.innerHTML = 'Erreur : Les données de posts ne sont pas disponibles ou le fichier list.js est manquant.';
                postsContainer.classList.add('empty-state');
            }
        };
    </script>

</body>
</html>